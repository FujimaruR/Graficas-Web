<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/Front/recursos/icono.png">
    <title>INFINITE SPACE</title>
    <link rel="stylesheet" href="/Front/css/MainGame.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Alfa+Slab+One&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>

<body>
    <div class="contenedor-todo">
        <div class="caja-blanca" id="MostrarMap">
            <!--<img src="/Front/recursos/cuadro-blanco.png.jpg" alt="invalid-img" class="box" id="box">-->
        </div>

        <div class="letra">
            <img src="/Front/recursos/PUNTOS.png" alt="invalid-img" class="box1" id="box1">
        </div>

        <a href="MenuPause.html">
            <div class="pause">
                <img src="/Front/recursos/pausa (3).png" alt="invalid-img" class="box5" id="box5">
            </div>
        </a>

        <div class="logo">
            <img src="/Front/recursos/logo.png" alt="initial-scale" class="box6" id="box6">
        </div>

        <div class="players">
            <img src="/Front/recursos/Imagenes/1jugadores.png" alt="invalid-img" class="box5" id="box7">
        </div>
    </div>

    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>-->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <!--<script src="/Back/MainGame.js"></script>-->

    <script type="module">
        import * as THREE from 'https://cdn.skypack.dev/three@0.136.0';
        import { OBJLoader } from 'https://cdn.skypack.dev/three@0.136.0/examples/jsm/loaders/OBJLoader';
        import { OrbitControls } from 'https://cdn.skypack.dev/three@0.136.0/examples/jsm/controls/OrbitControls';

        // Crear una escena
        const scene = new THREE.Scene();

        // Crear una cámara
        // Crear una cámara
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 0, 110); // Posición de la cámara
        camera.lookAt(0, 0, 0); // Mirar hacia el origen de la escena


        // Crear un renderizador con dimensiones específicas
        const renderer = new THREE.WebGLRenderer({ width: 800, height: 600 });
        renderer.setSize(800, 600);
        document.getElementById('MostrarMap').appendChild(renderer.domElement);


        // Agregar una luz ambiental
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5); // Color, intensidad
        scene.add(ambientLight);

        // Agregar una luz direccional
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5); // Color, intensidad
        directionalLight.position.set(0, 1, 0); // Posición de la luz
        scene.add(directionalLight);

        // Crear controles de órbita
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true; // Suavizado del movimiento de los controles
        controls.dampingFactor = 0.25; // Factor de amortiguación

        let object;

        // Cargar el modelo OBJ
        const loader = new OBJLoader();
        loader.load(
            '/Front/recursos/Modelos/Cohete1/10475_Rocket_Ship_v1_L3.obj',
            function (loadedObject) {

                object = loadedObject;
                // Ajustar la posición del modelo
                object.position.set(-45, -78, 0); // Modificar según sea necesario
                object.rotation.set(180, -0.1, 0.3);

                // Ajustar la escala del modelo
                object.scale.set(0.1, 0.1, 0.1); // Modificar según sea necesario

                scene.add(object);
            },
            function (xhr) {
                console.log((xhr.loaded / xhr.total * 100) + '% loaded');
            },
            function (error) {
                console.error('Error loading OBJ file:', error);
            }
        );

        // Función de animación
        function animate() {
            requestAnimationFrame(animate);
            controls.update(); // Actualizar controles de órbita
            renderer.render(scene, camera);
        }
        animate();

        // Variable para almacenar la velocidad de movimiento lateral
        const lateralSpeed = 10;
        const VerticalSpeed = 10;

        // Escuchar eventos de teclado
        document.addEventListener('keydown', (event) => {
            switch (event.key) {
                case 'a':
                case 'A':
                    // Mover el modelo hacia la izquierda
                    if (object && object.position.x - lateralSpeed >= -150) {
                        object.position.x -= lateralSpeed;
                    }
                    break;
                case 'd':
                case 'D':
                    // Mover el modelo hacia la derecha
                    if (object && object.position.x + lateralSpeed <= 80) {
                        object.position.x += lateralSpeed;
                    }
                    break;
                case 'w':
                case 'W':
                    // Mover el modelo hacia arriba
                    if (object && object.position.y + VerticalSpeed <= 70) {
                        object.position.y += VerticalSpeed;
                    }
                    break;

                case 's':
                case 'S':
                    // Mover el modelo hacia abajo
                    if (object && object.position.y + VerticalSpeed >= -65) {
                        object.position.y -= VerticalSpeed;
                    }
                    break;
            }
        });

        // Obtener la consulta de la URL
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);

        // Verificar si el parámetro 'jugadores' está presente y tiene el valor 2
        if (urlParams.has('jugadores') && urlParams.get('jugadores') === '2') {

            var segundaCajaBlanca = document.createElement('div');
            segundaCajaBlanca.className = 'caja-blanca segunda-caja-blanca'; // Asigna una clase diferente para el segundo contenedor
            segundaCajaBlanca.id = 'box2'
            document.body.appendChild(segundaCajaBlanca);

            var primeraCajaBlanca = document.querySelector('.caja-blanca');
            primeraCajaBlanca.style.right = '55%';



            // Crear una segunda escena, cámara y renderizador
            const secondScene = new THREE.Scene();
            const secondCamera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            secondCamera.position.set(0, 0, 110);
            secondCamera.lookAt(0, 0, 0);
            const secondRenderer = new THREE.WebGLRenderer({ width: 800, height: 600 });
            secondRenderer.setSize(800, 600);
            document.getElementById('box2').appendChild(secondRenderer.domElement);

            // Crear una segunda luz ambiental y direccional
            const secondAmbientLight = new THREE.AmbientLight(0xffffff, 0.5);
            secondScene.add(secondAmbientLight);
            const secondDirectionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
            secondDirectionalLight.position.set(0, 1, 0);
            secondScene.add(secondDirectionalLight);


            let secondObject;

            // Cargar el modelo OBJ en la segunda escena
            const secondLoader = new OBJLoader();
            secondLoader.load(
                '/Front/recursos/Modelos/Cohete1/10475_Rocket_Ship_v1_L3.obj',
                function (SecondloadedObject) {
                    secondObject = SecondloadedObject;
                    secondObject.position.set(-45, -78, 0);
                    secondObject.rotation.set(180, -0.1, 0.3);
                    secondObject.scale.set(0.1, 0.1, 0.1);
                    secondScene.add(secondObject);
                },
                function (xhr) {
                    console.log((xhr.loaded / xhr.total * 100) + '% loaded');
                },
                function (error) {
                    console.error('Error loading OBJ file:', error);
                }
            );

            // Función de animación para la segunda escena
            function animateSecondScene() {
                requestAnimationFrame(animateSecondScene);
                secondRenderer.render(secondScene, secondCamera);
            }
            animateSecondScene();


            const lateralSpeed2 = 10;
            const VerticalSpeed2 = 10;

            // Escuchar eventos de teclado
            document.addEventListener('keydown', (event) => {
                switch (event.key) {
                    case 'j':
                    case 'J':
                        // Mover el modelo hacia la izquierda
                        if (secondObject && secondObject.position.x - lateralSpeed2 >= -150) {
                            secondObject.position.x -= lateralSpeed2;
                        }
                        break;
                    case 'l':
                    case 'L':
                        // Mover el modelo hacia la derecha
                        if (secondObject && secondObject.position.x + lateralSpeed <= 80) {
                            secondObject.position.x += lateralSpeed;
                        }
                        break;
                    case 'i':
                    case 'I':
                        // Mover el modelo hacia arriba
                        if (secondObject && secondObject.position.y + VerticalSpeed2 <= 70) {
                            secondObject.position.y += VerticalSpeed2;
                        }
                        break;

                    case 'k':
                    case 'K':
                        // Mover el modelo hacia abajo
                        if (secondObject && secondObject.position.y + VerticalSpeed2 >= -65) {
                            secondObject.position.y -= VerticalSpeed2;
                        }
                        break;
                }
            });
        }

    </script>


</body>


</html>